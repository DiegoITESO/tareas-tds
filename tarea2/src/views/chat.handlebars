<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>{{title}}</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 2rem auto; }
    #messages { list-style: none; padding: 0; border: 1px solid #ddd; min-height: 200px; padding: 1rem; }
    #messages li { padding: 0.25rem 0; }
    form { display: flex; gap: 0.5rem; margin-top: 1rem; }
    input[type="text"] { flex: 1; padding: 0.5rem; }
  </style>
</head>
<body>
  <h2>ChatGPI</h2>

  <ul id="messages"></ul>

  <form id="chatForm" autocomplete="off">
    <input id="msgInput" type="text" placeholder="Type a message..." />
    <button type="submit">Send</button>
  </form>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    const messages = document.getElementById('messages');
    const form = document.getElementById('chatForm');
    const input = document.getElementById('msgInput');

    function appendMessage(text, me = false) {
      const li = document.createElement('li');
      li.textContent = text;
      if (me) li.style.fontWeight = '600';
      messages.appendChild(li);
      messages.scrollTop = messages.scrollHeight;
    }

    socket.on('chat:message', (msg) => {
      appendMessage(msg);
    });


    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const text = input.value.trim();
      if (!text) return;
      socket.emit('chat:message', text);
      appendMessage(`Me: ${text}`, true);
      input.value = '';
      input.focus();
    });
  </script>
</body>
</html>